{"ast":null,"code":"import _asyncToGenerator from\"/Users/finn.jones/Documents/Github/Blockchain-Voting/Testing/create-daml-app/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/finn.jones/Documents/Github/Blockchain-Voting/Testing/create-daml-app/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/finn.jones/Documents/Github/Blockchain-Voting/Testing/create-daml-app/ui/node_modules/@babel/runtime/regenerator/index.js\";// Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React,{useCallback}from\"react\";import{Button,TextField,Paper,Typography,Grid}from\"@mui/material\";import Ledger from\"@daml/ledger\";import{Voting}from\"@daml.js/create-daml-app\";import{authConfig,httpBaseUrl}from\"../config\";import{createHash}from\"crypto\";import{Link,useNavigate}from\"react-router-dom\";import{useAuth0}from\"@auth0/auth0-react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function hash(input){return createHash(\"sha256\").update(input).digest(\"hex\");}export var usernameExport;var wrap=function wrap(component){return/*#__PURE__*/ (// display VoteLogo.png\n_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Grid,{container:true,direction:\"column\",justifyContent:\"center\",alignItems:\"center\",style:{height:\"100vh\"},children:[/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Typography,{variant:\"h3\",color:\"primary\",textAlign:\"center\"// sx={{ pt: 2 }}#0d47a1\n,children:\"Votencrypt\"})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",fontWeight:\"600\",color:\"primary\",textAlign:\"center\"// sx={{ pt: 2 }}\n,children:\"Secure Voting On The Blockchain\"})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Paper,{sx:{p:2,borderRadius:\"16px\"},elevation:2,children:component})})]})}));};export var LandingScreen=function LandingScreen(_ref){var onLogin=_ref.onLogin;var _useAuth=useAuth0(),loginWithPopup=_useAuth.loginWithPopup;var _useAuth2=useAuth0(),user=_useAuth2.user,isAuthenticated=_useAuth2.isAuthenticated;var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),buttonPress=_React$useState2[0],setButtonPress=_React$useState2[1];var navigate=useNavigate();var login=useCallback(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(credentials){var ledger,userContract,userCreds;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;ledger=new Ledger({token:credentials.token,httpBaseUrl:httpBaseUrl});_context.next=4;return ledger.fetchByKey(Voting.User,credentials.party);case 4:userContract=_context.sent;if(!(userContract===null)){_context.next=10;break;}// const voteBob = useQuery()\nuserCreds={username:credentials.party};_context.next=9;return ledger.create(Voting.User,userCreds);case 9:userContract=_context.sent;case 10:navigate(\"/CreateVote\");onLogin(credentials);_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);alert(\"Unknown error:\\n\".concat(JSON.stringify(_context.t0)));case 17:case\"end\":return _context.stop();}}},_callee,null,[[0,14]]);}));return function(_x){return _ref2.apply(this,arguments);};}(),[onLogin]);var _React$useState3=React.useState(\"\"),_React$useState4=_slicedToArray(_React$useState3,2),username=_React$useState4[0],setUsername=_React$useState4[1];var handleLogin=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _ref4,name,picture,email,hashedUsername;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(user!==undefined)){_context2.next=6;break;}_ref4=user||{name:\"\",picture:\"\",email:\"\"},name=_ref4.name,picture=_ref4.picture,email=_ref4.email;// event.preventDefault();\nusernameExport=name;hashedUsername=hash(email);_context2.next=6;return login({party:hashedUsername,token:authConfig.makeToken(hashedUsername)});case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function handleLogin(){return _ref3.apply(this,arguments);};}();var handleLoginButton=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setButtonPress(true);if(isAuthenticated===false){loginWithPopup({screen_hint:\"signup\"});}case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function handleLoginButton(){return _ref5.apply(this,arguments);};}();console.log(isAuthenticated);if(isAuthenticated===true&&buttonPress===true){handleLogin();return/*#__PURE__*/_jsx(_Fragment,{});}else{return wrap(/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Grid,{container:true,direction:\"column\",style:{width:\"400px\"},spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",className:\"test-select-login-button\",onClick:handleLoginButton,style:{width:\"100%\"},children:\"Create A Vote\"})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",className:\"test-select-login-button\",component:Link,to:\"/VoteLogin\",style:{width:\"100%\"},children:\"Vote\"})})]})}));}};export var LoginScreenVote=function LoginScreenVote(_ref6){var onLogin=_ref6.onLogin;var navigate=useNavigate();var login=useCallback(/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(credentials){var ledger,userContract,user;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;ledger=new Ledger({token:credentials.token,httpBaseUrl:httpBaseUrl});_context4.next=4;return ledger.fetchByKey(Voting.User,credentials.party);case 4:userContract=_context4.sent;if(!(userContract===null)){_context4.next=10;break;}user={username:credentials.party};_context4.next=9;return ledger.create(Voting.User,user);case 9:userContract=_context4.sent;case 10:navigate(\"/Vote\");onLogin(credentials);_context4.next=17;break;case 14:_context4.prev=14;_context4.t0=_context4[\"catch\"](0);alert(\"Unknown error:\\n\".concat(JSON.stringify(_context4.t0)));case 17:case\"end\":return _context4.stop();}}},_callee4,null,[[0,14]]);}));return function(_x2){return _ref7.apply(this,arguments);};}(),[onLogin]);var _React$useState5=React.useState(\"\"),_React$useState6=_slicedToArray(_React$useState5,2),username=_React$useState6[0],setUsername=_React$useState6[1];var handleLogin=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(event){var hashedUsername;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:event.preventDefault();usernameExport=username;hashedUsername=hash(username);_context5.next=5;return login({party:hashedUsername,token:authConfig.makeToken(hashedUsername)});case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function handleLogin(_x3){return _ref8.apply(this,arguments);};}();return wrap(/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Grid,{container:true,direction:\"column\",style:{width:\"400px\"},children:[/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(TextField,{placeholder:\"Enter Vote Key\",value:username,className:\"test-select-username-field\",sx:{paddingBottom:2},style:{width:\"100%\"},onChange:function onChange(e){return setUsername(e.currentTarget.value);},onKeyPress:function onKeyPress(e){if(e.key===\"Enter\"){e.preventDefault();handleLogin(e);}}})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",className:\"test-select-login-button\",onClick:handleLogin,style:{width:\"100%\"},children:\"Vote\"})})]})}));};export var LoginScreenCreateVote=function LoginScreenCreateVote(_ref9){var onLogin=_ref9.onLogin;var navigate=useNavigate();var login=useCallback(/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(credentials){var ledger,userContract,user;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;ledger=new Ledger({token:credentials.token,httpBaseUrl:httpBaseUrl});_context6.next=4;return ledger.fetchByKey(Voting.User,credentials.party);case 4:userContract=_context6.sent;if(!(userContract===null)){_context6.next=10;break;}// const voteBob = useQuery()\nuser={username:credentials.party};_context6.next=9;return ledger.create(Voting.User,user);case 9:userContract=_context6.sent;case 10:navigate(\"/CreateVote\");onLogin(credentials);_context6.next=17;break;case 14:_context6.prev=14;_context6.t0=_context6[\"catch\"](0);alert(\"Unknown error:\\n\".concat(JSON.stringify(_context6.t0)));case 17:case\"end\":return _context6.stop();}}},_callee6,null,[[0,14]]);}));return function(_x4){return _ref10.apply(this,arguments);};}(),[onLogin]);var _React$useState7=React.useState(\"\"),_React$useState8=_slicedToArray(_React$useState7,2),username=_React$useState8[0],setUsername=_React$useState8[1];var handleLogin=/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(event){var hashedUsername;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:event.preventDefault();usernameExport=username;hashedUsername=hash(username);_context7.next=5;return login({party:hashedUsername,token:authConfig.makeToken(hashedUsername)});case 5:case\"end\":return _context7.stop();}}},_callee7);}));return function handleLogin(_x5){return _ref11.apply(this,arguments);};}();return wrap(/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Grid,{container:true,direction:\"column\",style:{width:\"400px\"},children:[/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(TextField,{placeholder:\"Username\",value:username,className:\"test-select-username-field\",sx:{paddingBottom:2},style:{width:\"100%\"},onChange:function onChange(e){return setUsername(e.currentTarget.value);},onKeyPress:function onKeyPress(e){if(e.key===\"Enter\"){e.preventDefault();handleLogin(e);}}})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",className:\"test-select-login-button\",onClick:handleLogin,style:{width:\"100%\"},children:\"Create A Vote\"})})]})}));};","map":{"version":3,"sources":["/Users/finn.jones/Documents/Github/Blockchain-Voting/Testing/create-daml-app/ui/src/components/LoginScreen.tsx"],"names":["React","useCallback","Button","TextField","Paper","Typography","Grid","Ledger","Voting","authConfig","httpBaseUrl","createHash","Link","useNavigate","useAuth0","hash","input","update","digest","usernameExport","wrap","component","height","p","borderRadius","LandingScreen","onLogin","loginWithPopup","user","isAuthenticated","useState","buttonPress","setButtonPress","navigate","login","credentials","ledger","token","fetchByKey","User","party","userContract","userCreds","username","create","alert","JSON","stringify","setUsername","handleLogin","undefined","name","picture","email","hashedUsername","makeToken","handleLoginButton","screen_hint","console","log","width","LoginScreenVote","event","preventDefault","paddingBottom","e","currentTarget","value","key","LoginScreenCreateVote"],"mappings":"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","sourcesContent":["// Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport React, { useCallback } from \"react\";\nimport { Button, TextField, Paper, Typography, Grid } from \"@mui/material\";\nimport Credentials from \"../Credentials\";\nimport Ledger from \"@daml/ledger\";\nimport { Voting } from \"@daml.js/create-daml-app\";\nimport { authConfig, httpBaseUrl } from \"../config\";\nimport { createHash } from \"crypto\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { useAuth0 } from \"@auth0/auth0-react\";\n\ntype Props = {\n  onLogin: (credentials: Credentials) => void;\n};\n\nfunction hash(input: string) {\n  return createHash(\"sha256\").update(input).digest(\"hex\");\n}\n\nexport let usernameExport: any;\nconst wrap: (c: JSX.Element) => JSX.Element = (component) => (\n  // display VoteLogo.png\n  <>\n    <Grid\n      container\n      direction=\"column\"\n      justifyContent=\"center\"\n      alignItems=\"center\"\n      style={{ height: \"100vh\" }}\n    >\n      <Grid item>\n        <Typography\n          variant=\"h3\"\n          color=\"primary\"\n          textAlign=\"center\"\n          // sx={{ pt: 2 }}#0d47a1\n        >\n          Votencrypt\n        </Typography>\n      </Grid>\n      <Grid item>\n        <Typography\n          variant=\"h6\"\n          fontWeight=\"600\"\n          color=\"primary\"\n          textAlign=\"center\"\n          // sx={{ pt: 2 }}\n        >\n          Secure Voting On The Blockchain\n        </Typography>\n      </Grid>\n      <Grid item>\n        <Paper sx={{ p: 2, borderRadius: \"16px\" }} elevation={2}>\n          {component}\n        </Paper>\n      </Grid>\n    </Grid>\n  </>\n);\n\nexport const LandingScreen: React.FC<Props> = ({ onLogin }) => {\n  const { loginWithPopup } = useAuth0();\n  const { user, isAuthenticated } = useAuth0();\n  const [buttonPress, setButtonPress] = React.useState(false);\n  const navigate = useNavigate();\n\n  const login = useCallback(\n    async (credentials: Credentials) => {\n      try {\n        const ledger = new Ledger({ token: credentials.token, httpBaseUrl });\n        let userContract = await ledger.fetchByKey(\n          Voting.User,\n          credentials.party\n        );\n\n        if (userContract === null) {\n          // const voteBob = useQuery()\n\n          const userCreds = {\n            username: credentials.party,\n          };\n          userContract = await ledger.create(Voting.User, userCreds);\n        }\n        navigate(\"/CreateVote\");\n\n        onLogin(credentials);\n      } catch (error) {\n        alert(`Unknown error:\\n${JSON.stringify(error)}`);\n      }\n    },\n    [onLogin]\n  );\n  const [username, setUsername] = React.useState(\"\");\n\n  const handleLogin = async () => {\n    // if user is not undefined then run\n\n    if (user !== undefined) {\n      const { name, picture, email } = user || {\n        name: \"\",\n        picture: \"\",\n        email: \"\",\n      };\n\n      // event.preventDefault();\n      usernameExport = name;\n      const hashedUsername = hash(email);\n      await login({\n        party: hashedUsername,\n        token: authConfig.makeToken(hashedUsername),\n      });\n    }\n  };\n  const handleLoginButton = async () => {\n    setButtonPress(true);\n    if (isAuthenticated === false) {\n      loginWithPopup({\n        screen_hint: \"signup\",\n      });\n    }\n  };\n  console.log(isAuthenticated);\n  if (isAuthenticated === true && buttonPress === true) {\n    handleLogin();\n    return <></>;\n  } else {\n    return wrap(\n      <>\n        <Grid\n          container\n          direction=\"column\"\n          style={{ width: \"400px\" }}\n          spacing={2}\n        >\n          <Grid item>\n            <Button\n              variant=\"contained\"\n              color=\"primary\"\n              className=\"test-select-login-button\"\n              onClick={handleLoginButton}\n              style={{ width: \"100%\" }}\n            >\n              Create A Vote\n            </Button>\n          </Grid>\n          <Grid item>\n            <Button\n              variant=\"contained\"\n              color=\"primary\"\n              className=\"test-select-login-button\"\n              component={Link}\n              to=\"/VoteLogin\"\n              style={{ width: \"100%\" }}\n            >\n              Vote\n            </Button>\n          </Grid>\n        </Grid>\n      </>\n    );\n  }\n};\n\nexport const LoginScreenVote: React.FC<Props> = ({ onLogin }) => {\n  const navigate = useNavigate();\n\n  const login = useCallback(\n    async (credentials: Credentials) => {\n      try {\n        const ledger = new Ledger({ token: credentials.token, httpBaseUrl });\n        let userContract = await ledger.fetchByKey(\n          Voting.User,\n          credentials.party\n        );\n\n        if (userContract === null) {\n          const user = {\n            username: credentials.party,\n          };\n          userContract = await ledger.create(Voting.User, user);\n        }\n        navigate(\"/Vote\");\n\n        onLogin(credentials);\n      } catch (error) {\n        alert(`Unknown error:\\n${JSON.stringify(error)}`);\n      }\n    },\n    [onLogin]\n  );\n  const [username, setUsername] = React.useState(\"\");\n\n  const handleLogin = async (event: React.FormEvent) => {\n    event.preventDefault();\n    usernameExport = username;\n\n    const hashedUsername = hash(username);\n\n    await login({\n      party: hashedUsername,\n      token: authConfig.makeToken(hashedUsername),\n    });\n  };\n\n  return wrap(\n    <>\n      <Grid container direction=\"column\" style={{ width: \"400px\" }}>\n        <Grid item>\n          <TextField\n            placeholder=\"Enter Vote Key\"\n            value={username}\n            className=\"test-select-username-field\"\n            sx={{ paddingBottom: 2 }}\n            style={{ width: \"100%\" }}\n            onChange={(e) => setUsername(e.currentTarget.value)}\n            onKeyPress={(e) => {\n              if (e.key === \"Enter\") {\n                e.preventDefault();\n                handleLogin(e);\n              }\n            }}\n          />\n        </Grid>\n\n        <Grid item>\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            className=\"test-select-login-button\"\n            onClick={handleLogin}\n            style={{ width: \"100%\" }}\n          >\n            Vote\n          </Button>\n        </Grid>\n      </Grid>\n    </>\n  );\n};\n\nexport const LoginScreenCreateVote: React.FC<Props> = ({ onLogin }) => {\n  const navigate = useNavigate();\n\n  const login = useCallback(\n    async (credentials: Credentials) => {\n      try {\n        const ledger = new Ledger({ token: credentials.token, httpBaseUrl });\n        let userContract = await ledger.fetchByKey(\n          Voting.User,\n          credentials.party\n        );\n\n        if (userContract === null) {\n          // const voteBob = useQuery()\n\n          const user = {\n            username: credentials.party,\n          };\n          userContract = await ledger.create(Voting.User, user);\n        }\n        navigate(\"/CreateVote\");\n\n        onLogin(credentials);\n      } catch (error) {\n        alert(`Unknown error:\\n${JSON.stringify(error)}`);\n      }\n    },\n    [onLogin]\n  );\n  const [username, setUsername] = React.useState(\"\");\n\n  const handleLogin = async (event: React.FormEvent) => {\n    event.preventDefault();\n    usernameExport = username;\n    const hashedUsername = hash(username);\n\n    await login({\n      party: hashedUsername,\n      token: authConfig.makeToken(hashedUsername),\n    });\n  };\n  return wrap(\n    <>\n      {/* FORM_BEGIN */}\n      <Grid container direction=\"column\" style={{ width: \"400px\" }}>\n        <Grid item>\n          <TextField\n            placeholder=\"Username\"\n            value={username}\n            className=\"test-select-username-field\"\n            sx={{ paddingBottom: 2 }}\n            style={{ width: \"100%\" }}\n            onChange={(e) => setUsername(e.currentTarget.value)}\n            onKeyPress={(e) => {\n              if (e.key === \"Enter\") {\n                e.preventDefault();\n                handleLogin(e);\n              }\n            }}\n          />\n        </Grid>\n        <Grid item>\n          <Button\n            variant=\"contained\"\n            className=\"test-select-login-button\"\n            onClick={handleLogin}\n            style={{ width: \"100%\" }}\n          >\n            Create A Vote\n          </Button>\n        </Grid>\n      </Grid>\n    </>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}