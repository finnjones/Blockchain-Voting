(this.webpackJsonpvotencrypt=this.webpackJsonpvotencrypt||[]).push([[0],{415:function(e,t,n){},420:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(421))},421:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(174),c=n(212),r=(n(133),n(422));t.Vote={decoder:c.lazyMemo((function(){return a.object({voter:c.Party.decoder,vote:c.Text.decoder,unixTime:c.Int.decoder})})),encode:function(e){return{voter:c.Party.encode(e.voter),vote:c.Text.encode(e.vote),unixTime:c.Int.encode(e.unixTime)}}},t.Voting={templateId:"5ea1b66908dcd5d9a7a2e7417b1c1a22a1ed31a424113939d3478c2e94172e73:Voting:Voting",keyDecoder:c.lazyMemo((function(){return c.lazyMemo((function(){return c.Party.decoder}))})),keyEncode:function(e){return c.Party.encode(e)},decoder:c.lazyMemo((function(){return a.object({username:c.Party.decoder,deadLine:c.Text.decoder,voters:c.List(c.Party).decoder,votes:c.List(c.Text).decoder,voted:c.List(c.Party).decoder,voteTimes:c.List(c.Int).decoder,options:c.List(c.Text).decoder,subject:c.Text.decoder})})),encode:function(e){return{username:c.Party.encode(e.username),deadLine:c.Text.encode(e.deadLine),voters:c.List(c.Party).encode(e.voters),votes:c.List(c.Text).encode(e.votes),voted:c.List(c.Party).encode(e.voted),voteTimes:c.List(c.Int).encode(e.voteTimes),options:c.List(c.Text).encode(e.options),subject:c.Text.encode(e.subject)}},Archive:{template:function(){return t.Voting},choiceName:"Archive",argumentDecoder:c.lazyMemo((function(){return r.DA.Internal.Template.Archive.decoder})),argumentEncode:function(e){return r.DA.Internal.Template.Archive.encode(e)},resultDecoder:c.lazyMemo((function(){return c.Unit.decoder})),resultEncode:function(e){return c.Unit.encode(e)}},Vote:{template:function(){return t.Voting},choiceName:"Vote",argumentDecoder:c.lazyMemo((function(){return t.Vote.decoder})),argumentEncode:function(e){return t.Vote.encode(e)},resultDecoder:c.lazyMemo((function(){return c.ContractId(t.Voting).decoder})),resultEncode:function(e){return c.ContractId(t.Voting).encode(e)}}},c.registerTemplate(t.Voting),t.User={templateId:"5ea1b66908dcd5d9a7a2e7417b1c1a22a1ed31a424113939d3478c2e94172e73:Voting:User",keyDecoder:c.lazyMemo((function(){return c.lazyMemo((function(){return c.Party.decoder}))})),keyEncode:function(e){return c.Party.encode(e)},decoder:c.lazyMemo((function(){return a.object({username:c.Party.decoder})})),encode:function(e){return{username:c.Party.encode(e.username)}},Archive:{template:function(){return t.User},choiceName:"Archive",argumentDecoder:c.lazyMemo((function(){return r.DA.Internal.Template.Archive.decoder})),argumentEncode:function(e){return r.DA.Internal.Template.Archive.encode(e)},resultDecoder:c.lazyMemo((function(){return c.Unit.decoder})),resultEncode:function(e){return c.Unit.encode(e)}}},c.registerTemplate(t.User)},422:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(423);t.DA=a,t.packageId="d14e08374fc7197d6a0de468c968ae8ba3aadbf9315476fd39071831f5923662"},423:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(424);t.Internal=a},424:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(425);t.Template=a},425:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(426))},426:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(174),c=n(212);n(133);t.Archive={decoder:c.lazyMemo((function(){return a.object({})})),encode:function(e){return{}}}},432:function(e,t){},434:function(e,t){},444:function(e,t){},446:function(e,t){},472:function(e,t){},474:function(e,t){},475:function(e,t){},480:function(e,t){},482:function(e,t){},488:function(e,t){},490:function(e,t){},509:function(e,t){},52:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(420);t.Voting=a,t.packageId="5ea1b66908dcd5d9a7a2e7417b1c1a22a1ed31a424113939d3478c2e94172e73"},521:function(e,t){},524:function(e,t){},661:function(e,t,n){"use strict";n.r(t);var a,c=n(0),r=n.n(c),o=n(75),i=n.n(o),s=(n(415),n(8)),l=n(80),j=n(43),d=n.n(j),u=n(762),b=n(767),h=n(768),x=n(763),O=n(751),p=n(772),v=n(133),m=n.n(v),f=n(52),g=n(365),y=function(){var e,t=null!==(e=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTH0_CLIENT_ID:"MeM1EPfpL5s7EG7hdki3aBTQa5wuCcYu",REACT_APP_AUTH0_DOMAIN:"votencrypt.au.auth0.com"}).REACT_APP_LEDGER_ID)&&void 0!==e?e:"votencrypt-sandbox";return{provider:"none",ledgerId:t,makeToken:function(e){var n={"https://daml.com/ledger-api":{ledgerId:t,applicationId:"votencrypt",actAs:[e]}};return Object(g.encode)(n,"secret","HS256")}}}(),k=void 0,V=n(134),w=n(31),C=n(60),S=n(117),T=n(753),A=n(1);function L(e){return Object(V.createHash)("sha256").update(e).digest("hex")}var D=function(e){return Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)(u.a,{container:!0,direction:"column",justifyContent:"center",alignItems:"center",style:{height:"100vh"},children:[Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(b.a,{variant:"h3",color:"primary",textAlign:"center",children:"Votencrypt"})}),Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(b.a,{variant:"h6",fontWeight:"600",color:"primary",textAlign:"center",children:"Secure Voting On The Blockchain"})}),Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(h.a,{sx:{p:2,borderRadius:"16px"},elevation:2,children:e})})]})})},I=function(e){var t=e.onLogin,n=Object(S.b)().loginWithPopup,o=Object(S.b)(),i=o.user,j=o.isAuthenticated,b=r.a.useState(!1),h=Object(s.a)(b,2),O=h[0],p=h[1],v=Object(w.f)(),g=Object(c.useCallback)(function(){var e=Object(l.a)(d.a.mark((function e(n){var a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=new m.a({token:n.token,httpBaseUrl:k}),e.next=4,a.fetchByKey(f.Voting.User,n.party);case 4:if(null!==e.sent){e.next=10;break}return c={username:n.party},e.next=9,a.create(f.Voting.User,c);case 9:e.sent;case 10:v("/CreateVote"),t(n),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),alert("Unknown error:\n".concat(JSON.stringify(e.t0)));case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),[t]),V=function(){var e=Object(l.a)(d.a.mark((function e(){var t,n,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i){e.next=6;break}return t=i.name,n=i.sub,a=t,c=L(n||""),e.next=6,g({party:c,token:y.makeToken(c)});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=Object(l.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(!0),!1===j&&n({screen_hint:"signup"});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return!0===j&&!0===O?(V(),Object(A.jsx)(A.Fragment,{})):D(Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)(u.a,{container:!0,direction:"column",style:{width:"400px"},spacing:2,children:[Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(T.a,{variant:"contained",color:"primary",onClick:I,style:{width:"100%"},loading:O,children:"Login"})}),Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(x.a,{variant:"contained",color:"primary",className:"test-select-login-button",component:C.b,to:"/VoteLogin",style:{width:"100%"},children:"Vote"})})]})}))},M=function(e){var t=e.onLogin,n=Object(w.f)(),o=r.a.useState(!1),i=Object(s.a)(o,2),j=i[0],b=i[1],h=Object(c.useCallback)(function(){var e=Object(l.a)(d.a.mark((function e(a){var c,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=new m.a({token:a.token,httpBaseUrl:k}),e.next=4,c.fetchByKey(f.Voting.User,a.party);case 4:if(null!==e.sent){e.next=10;break}return r={username:a.party},e.next=9,c.create(f.Voting.User,r);case 9:e.sent;case 10:n("/Vote"),t(a),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),alert("Unknown error:\n".concat(JSON.stringify(e.t0)));case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),[t]),x=r.a.useState(""),v=Object(s.a)(x,2),g=v[0],V=v[1],C=function(){var e=Object(l.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g,t=L(g),e.next=4,h({party:t,token:y.makeToken(t)});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return window.location.pathname.length<="/VoteLogin/".length?D(Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)(u.a,{container:!0,direction:"column",style:{width:"400px"},children:[Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(O.a,{placeholder:"Enter Vote Key",value:g,className:"test-select-username-field",sx:{paddingBottom:2},style:{width:"100%"},onChange:function(e){return V(e.currentTarget.value)},onKeyPress:function(e){"Enter"===e.key&&""!==g&&(e.preventDefault(),C())}})}),Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(T.a,{color:"primary",onClick:function(e){""!==g&&(b(!0),e.preventDefault(),C())},loading:j,variant:"contained",style:{width:"100%"},children:"Vote"})})]})})):(""===g&&(V(window.location.pathname.substring("/VoteLogin/".length,window.location.pathname.length)),C()),Object(A.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",sx:{display:"flex",height:"100vh"},children:Object(A.jsx)("img",{src:"/preLoader.svg"})}))},P=function(e){var t=e.onLogout,n=Object(w.f)();return Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",style:{height:"100vh"},children:Object(A.jsxs)(h.a,{sx:{p:3,borderRadius:"16px"},elevation:2,children:[Object(A.jsx)(b.a,{variant:"h5",sx:{flexGrow:1},noWrap:!0,children:"Are you sure you want to logout?"}),Object(A.jsx)(x.a,{variant:"contained",color:"primary",component:C.b,to:"/",onClick:t,sx:{m:2},children:"Log Out"}),Object(A.jsx)(x.a,{variant:"contained",color:"primary",onClick:function(){return n(1)},sx:{m:2},children:"Take me back"})]})})})},E=n(773),_=n(774),z=n(775),F=n(764),U=n(771),N=n(758),R=n(776),H=n(777),K=n(368),B=n.n(K),W=n(730),Y=n(731),G=n(732),Q=n(733),J=function(e){e.onLogout;var t=Object(S.b)().logout,n=r.a.useState(!1),c=Object(s.a)(n,2),o=c[0],i=c[1];return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(p.a,{sx:{flexGrow:1,m:2},children:Object(A.jsx)(E.a,{position:"static",sx:{borderRadius:"16px"},children:Object(A.jsxs)(_.a,{children:[Object(A.jsx)(z.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:function(){i(!0)},className:"menu-button",children:Object(A.jsx)(B.a,{})}),Object(A.jsx)(b.a,{variant:"h5",children:"Votencrypt"}),Object(A.jsx)(b.a,{sx:{flexGrow:1},noWrap:!0}),Object(A.jsx)(x.a,{variant:"outlined",color:"inherit",startIcon:Object(A.jsx)(W.a,{}),onClick:function(){t({returnTo:window.location.origin})},children:"Log Out"})]})})}),Object(A.jsxs)(b.a,{variant:"h3",textAlign:"center",color:"primary",sx:{padding:3},children:["Welcome, ",a]}),Object(A.jsx)(F.a,{anchor:"left",open:o,onClose:function(){return i(!1)},children:Object(A.jsxs)(p.a,{p:2,width:"250px",textAlign:"center",role:"presentation",children:[Object(A.jsx)(b.a,{variant:"h6",component:"div",children:"Menu"}),Object(A.jsxs)(U.a,{children:[Object(A.jsxs)(N.a,{button:!0,component:C.b,to:"/CreateVote",className:"test-select-list-item",children:[Object(A.jsx)(R.a,{children:Object(A.jsx)(Y.a,{})}),Object(A.jsx)(H.a,{primary:"Create Vote"})]}),Object(A.jsxs)(N.a,{button:!0,component:C.b,to:"/VoteAnalytics",className:"test-select-list-item",children:[Object(A.jsx)(R.a,{children:Object(A.jsx)(G.a,{})}),Object(A.jsx)(H.a,{primary:"Analytics"})]}),Object(A.jsxs)(N.a,{button:!0,component:C.b,to:"/VoteManagement",className:"test-select-list-item",children:[Object(A.jsx)(R.a,{children:Object(A.jsx)(Q.a,{})}),Object(A.jsx)(H.a,{primary:"Vote Management"})]})]})]})})]})},X=n(778),q=n(779),Z=n(759),$=n(769),ee=n(726),te=n(765),ne=n(780),ae=n(754),ce=n(734),re=n(735),oe=n(55),ie=n.n(oe),se=n(163),le=n.n(se),je={days:"00",hours:"00",minutes:"00",seconds:"00"};function de(e,t){return t.diff(e,"seconds")%60}function ue(e,t){return t.diff(e,"minutes")%60}function be(e,t){return t.diff(e,"hours")%24}function he(e,t){return t.diff(e,"days")}var xe=function(){var e,t,n=(null===(e=Object(oe.useStreamQueries)(f.Voting.Voting).contracts[0])||void 0===e||null===(t=e.payload)||void 0===t?void 0:t.deadLine)||"0",a=1e3*parseInt(n),r=Object(c.useState)(je),o=Object(s.a)(r,2),i=o[0],l=o[1];return Object(c.useEffect)((function(){var e=setInterval((function(){l(function(e){var t=le()(e),n=le()();return t.isBefore(n)?{days:"00",hours:"00",minutes:"00",seconds:"00"}:{seconds:de(n,t).toString(),minutes:ue(n,t).toString(),hours:be(n,t).toString(),days:he(n,t).toString()}}(a))}),1e3);return function(){return clearInterval(e)}}),[a]),"0"===n?Object(A.jsx)(b.a,{children:" "}):Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)(b.a,{variant:"h5",children:["Vote Ends In: ",i.days," Days ",i.hours," Hours"," ",i.minutes," Minutes ",i.seconds," Seconds"]})})},Oe=function(e){var t,n,a=e.onLogout,o=Object(oe.useParty)(),i=Object(oe.useLedger)(),j=r.a.useState(!1),O=Object(s.a)(j,2),v=O[0],m=O[1],g=r.a.useState(!1),y=Object(s.a)(g,2),k=y[0],V=y[1],w=r.a.useState(""),S=Object(s.a)(w,2),T=S[0],L=S[1],D=function(e,t){"clickaway"!==t&&V(!1)},I=Object(A.jsx)(r.a.Fragment,{children:Object(A.jsx)(z.a,{size:"small","aria-label":"close",color:"inherit",onClick:D,children:Object(A.jsx)(ce.a,{fontSize:"small"})})}),M=Object(oe.useStreamQueries)(f.Voting.Voting),P=Object(c.useState)(""),E=Object(s.a)(P,2),_=E[0],F=E[1],R=function(){return!0===M.loading?"Loading...":void 0===M.contracts[0]?"Invalid Vote Key":null===(e=M.contracts[0])||void 0===e||null===(t=e.payload)||void 0===t?void 0:t.subject;var e,t},H=(new Date).getTime(),K=function(){var e=Object(l.a)(d.a.mark((function e(){var t,n,a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===_){e.next=18;break}if(!(H<1e3*parseInt(null===(t=M.contracts[0])||void 0===t||null===(n=t.payload)||void 0===n?void 0:n.deadLine))){e.next=14;break}if(null===(a=M.contracts[0])||void 0===a||!a.payload.voted.includes(o)){e.next=7;break}L("You have already voted"),V(!0),e.next=12;break;case 7:return e.next=9,i.exerciseByKey(f.Voting.Voting.Vote,null===(c=M.contracts[0])||void 0===c?void 0:c.signatories[0],{voter:o,vote:_,unixTime:H.toString()}).catch(console.error);case 9:m(!0),L("Your vote has been cast. Please logout or close the browser tab"),V(!0);case 12:e.next=16;break;case 14:L("The voting period has ended"),V(!0);case 16:e.next=20;break;case 18:L("Please select an option"),V(!0);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return v?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(p.a,{textAlign:"right",sx:{p:1},children:Object(A.jsx)(x.a,{variant:"outlined",color:"inherit",startIcon:Object(A.jsx)(W.a,{}),onClick:a,component:C.b,to:"/",children:"Log Out"})}),Object(A.jsx)(X.a,{children:Object(A.jsx)(u.a,{container:!0,direction:"column",justifyContent:"center",alignItems:"center",style:{height:"75vh"},children:Object(A.jsxs)(h.a,{sx:{p:3,borderRadius:"16px",width:"90%"},elevation:2,children:[Object(A.jsxs)(u.a,{container:!0,spacing:0,children:[Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(re.a,{sx:{fontSize:50},color:"primary"})}),Object(A.jsxs)(u.a,{item:!0,children:[Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(b.a,{variant:"h5",display:"block",children:"Thank you for voting"})}),Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(b.a,{variant:"subtitle1",color:"secondary",display:"block",style:{lineHeight:"15px"},children:"Vote has been cast"})})]})]}),Object(A.jsx)(q.a,{}),Object(A.jsx)(b.a,{variant:"h6",sx:{pt:2},children:"Vote Description"}),R(),Object(A.jsx)(b.a,{variant:"h6",sx:{pt:2},children:"You Voted For"}),_,Object(A.jsx)(Z.a,{open:k,autoHideDuration:4e3,onClose:D,message:T,action:I})]})})})]}):Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(p.a,{textAlign:"right",sx:{p:1},children:Object(A.jsx)(x.a,{variant:"outlined",color:"inherit",startIcon:Object(A.jsx)(W.a,{}),onClick:a,component:C.b,to:"/",children:"Log Out"})}),Object(A.jsx)(X.a,{children:Object(A.jsx)(u.a,{container:!0,direction:"column",justifyContent:"center",alignItems:"center",style:{height:"75vh"},children:Object(A.jsxs)(h.a,{sx:{p:3,borderRadius:"16px",width:"90%"},elevation:2,children:[Object(A.jsxs)(u.a,{container:!0,spacing:0,children:[Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(re.a,{sx:{fontSize:50},color:"primary"})}),Object(A.jsxs)(u.a,{item:!0,children:[Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(b.a,{variant:"h5",display:"block",children:"Vote"})}),Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(b.a,{variant:"subtitle1",color:"secondary",display:"block",style:{lineHeight:"15px"},children:"Read the vote description carefully and choose an option"})})]})]}),Object(A.jsx)(q.a,{}),Object(A.jsx)(xe,{}),Object(A.jsx)(b.a,{variant:"h6",sx:{pt:2},children:"Vote Description"}),R(),Object(A.jsx)(q.a,{sx:{pb:2}}),Object(A.jsx)(p.a,{textAlign:"center",children:Object(A.jsxs)($.a,{children:[Object(A.jsx)(ee.a,{id:"demo-radio-buttons-group-label",children:"Options"}),Object(A.jsx)(te.a,{"aria-labelledby":"demo-radio-buttons-group-label",defaultValue:"female",name:"radio-buttons-group",children:Object(A.jsx)(U.a,{children:null===(t=M.contracts[0])||void 0===t||null===(n=t.payload)||void 0===n?void 0:n.options.map((function(e){return Object(A.jsx)(N.a,{children:Object(A.jsx)(ne.a,{value:e,control:Object(A.jsx)(ae.a,{}),label:e,onChange:function(t){F(e)}})},e)}))})})]})}),Object(A.jsx)(p.a,{textAlign:"center",children:Object(A.jsx)(x.a,{variant:"contained",onClick:K,className:"button",name:"Create Vote",sx:{m:2,alignItems:"center"},children:"Vote"})}),Object(A.jsx)(Z.a,{open:k,autoHideDuration:4e3,onClose:D,message:T,action:I})]})})})]})},pe=n(748),ve=n(29),me=n(69),fe=n(755),ge=n(737),ye=n(738),ke=n(739),Ve=n(781),we=n(760),Ce=n(736),Se=function(e){var t=e.heading,n=e.content,a=c.useState(!1),r=Object(s.a)(a,2),o=r[0],i=r[1];return Object(A.jsxs)("div",{children:[Object(A.jsx)(we.a,{ariaLabel:"SpeedDial basic example",sx:{position:"fixed",bottom:16,right:16},icon:Object(A.jsx)(Ce.a,{}),onClick:function(){i(!0)}}),Object(A.jsxs)(Ve.a,{open:o,onClose:function(e){i(!1)},children:[Object(A.jsx)(b.a,{variant:"h6",textAlign:"center",sx:{p:1},children:t}),Object(A.jsx)(p.a,{sx:{p:4},children:Object(A.jsx)(b.a,{variant:"h6",style:{whiteSpace:"pre-line"},children:n.split("\\n").map((function(e,t){return Object(A.jsx)("div",{children:e},t)}))})})]})]})},Te=n(749),Ae=n(390),Le=n(750),De=[],Ie=function(){var e=Object(oe.useParty)(),t=Object(c.useState)([]),a=Object(s.a)(t,2),o=a[0],i=a[1],j=Object(c.useState)([]),v=Object(s.a)(j,2),m=v[0],g=v[1],y=r.a.useState(10),k=Object(s.a)(y,2),w=k[0],C=k[1],S=Object(c.useState)(""),T=Object(s.a)(S,2),L=T[0],D=T[1],I=Object(c.useState)(""),M=Object(s.a)(I,2),P=M[0],E=M[1],_=r.a.useState(!1),F=Object(s.a)(_,2),R=F[0],K=F[1],B=r.a.useState(""),W=Object(s.a)(B,2),G=W[0],Q=W[1],J=r.a.useState(new Date),$=Object(s.a)(J,2),ee=$[0],te=$[1],ne=r.a.useState({Subject:!1,Option:!1}),ae=Object(s.a)(ne,2),re=ae[0],ie=ae[1],se=r.a.useState(!0),le=Object(s.a)(se,2),je=le[0],de=le[1],ue=Object(oe.useStreamQueries)(f.Voting.Voting),be=new Date,he=Object(oe.useLedger)(),xe=n(134),Oe=function(){var t=Object(l.a)(d.a.mark((function t(n){var a,c,r,i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),a={Subject:!1,Option:!1},a=0===L.length?Object(me.a)(Object(me.a)({},a),{},{Subject:!0}):Object(me.a)(Object(me.a)({},a),{},{Subject:!1}),a=0===o.length?Object(me.a)(Object(me.a)({},a),{},{Option:!0}):Object(me.a)(Object(me.a)({},a),{},{Option:!1}),ie(a),null!==ee&&""!==L&&0!==o.length&&ee.getTime()>be.getTime()&&(0===ue.contracts.length?(c=pe(w),g(c[0]),r=null!==ee?Math.floor(ee.getTime()/1e3):0,i={username:e,deadLine:r.toString(),voters:De,votes:[],voted:[],voteTimes:[],options:o,subject:L},he.create(f.Voting.Voting,i),Q("Vote Created. Save Keys Before Closing App"),K(!0),de(!1)):(Q("Vote In Progress"),K(!0)));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();var pe=function(e){for(var t=0;t<e;t++){var n=xe.randomBytes(20).toString("hex");m.push("".concat(n)),De.push((a=n,Object(V.createHash)("sha256").update(a).digest("hex")))}var a;return[m,De]},Ve=function(){o.includes(P)?(Q("Option already exists"),K(!0)):(E(""),i([P].concat(Object(ve.a)(o))))},we=function(e,t){"clickaway"!==t&&K(!1)},Ce=Object(A.jsx)(r.a.Fragment,{children:Object(A.jsx)(z.a,{size:"small","aria-label":"close",color:"inherit",onClick:we,children:Object(A.jsx)(ce.a,{fontSize:"small"})})});return Object(A.jsxs)(X.a,{children:[Object(A.jsx)(p.a,{sx:{p:1},children:Object(A.jsxs)(h.a,{sx:{p:3,borderRadius:"16px"},elevation:2,children:[Object(A.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[Object(A.jsx)(Y.a,{sx:{fontSize:45},color:"primary"}),Object(A.jsx)(b.a,{variant:"h5",children:"Create A Vote"})]}),Object(A.jsx)(q.a,{sx:{p:0}}),Object(A.jsx)(b.a,{variant:"h6",sx:{pt:2},children:"What is the vote on?"}),Object(A.jsx)(p.a,{textAlign:"center",children:Object(A.jsx)(O.a,{id:"outlined-basic",label:"Subject",variant:"outlined",value:L,onClick:function(){ie(Object(me.a)(Object(me.a)({},re),{},{Subject:!1}))},onChange:function(e){D(e.target.value)},error:re.Subject,style:{width:"94%"},sx:{m:2}})}),Object(A.jsxs)(b.a,{variant:"h6",children:["Voters: ",w]}),Object(A.jsx)(p.a,{textAlign:"center",children:Object(A.jsx)(fe.a,{value:w,"aria-label":"Default",valueLabelDisplay:"auto",name:"slider",sx:{m:2},style:{width:"95%"},onChange:function(e){C(e.target.value)}})}),Object(A.jsxs)(b.a,{variant:"h6",children:["Vote Options: ",o.length]}),Object(A.jsxs)(p.a,{textAlign:"center",children:[Object(A.jsx)(O.a,{id:"outlined-basic",label:"Option",variant:"outlined",value:P,error:re.Option,onClick:function(){ie(Object(me.a)(Object(me.a)({},re),{},{Option:!1}))},onChange:function(e){E(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),Ve())},style:{width:"95%"},sx:{m:2},InputProps:{endAdornment:Object(A.jsx)(z.a,{onClick:Ve,children:Object(A.jsx)(ge.a,{})})}}),Object(A.jsx)(U.a,{style:{width:"95%"},sx:{ml:2},children:o.map((function(e){return Object(A.jsx)(N.a,{secondaryAction:Object(A.jsx)(z.a,{edge:"end","aria-label":"delete",onClick:function(t){i((function(t){return t.filter((function(t){return t!==e}))}))},children:Object(A.jsx)(ye.a,{})}),children:Object(A.jsx)(H.a,{primary:e})},e)}))})]}),Object(A.jsx)(p.a,{textAlign:"center",children:Object(A.jsx)(Ae.a,{dateAdapter:Te.a,children:Object(A.jsx)(Le.a,{label:"Vote Deadline",value:ee,minDateTime:be,onChange:function(e){te(e)},renderInput:function(e){return Object(A.jsx)(O.a,Object(me.a)({},e))}})})}),Object(A.jsx)(p.a,{textAlign:"center",children:Object(A.jsx)(x.a,{variant:"contained",onClick:Oe,className:"button",name:"Create Vote",sx:{m:2,alignItems:"center"},children:"Create Vote"})}),Object(A.jsx)(Z.a,{open:R,onClose:we,message:G,action:Ce})]})}),Object(A.jsx)(p.a,{sx:{p:1},children:Object(A.jsxs)(h.a,{sx:{p:3,borderRadius:"16px"},elevation:2,children:[Object(A.jsxs)(u.a,{container:!0,children:[Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(ke.a,{sx:{fontSize:45},color:"primary"})}),Object(A.jsxs)(u.a,{item:!0,children:[Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(b.a,{variant:"h5",display:"block",children:"Vote Keys"})}),Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(b.a,{variant:"subtitle1",color:"secondary",display:"block",style:{lineHeight:"15px"},children:"Send each voter a key to vote"})})]}),Object(A.jsxs)(p.a,{textAlign:"right",sx:{flexGrow:1},children:[Object(A.jsx)(x.a,{sx:{margin:1},variant:"contained",onClick:function(){var e=m.join("\n"),t=new Blob([e],{type:"text/csv"}),n=URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download=L+".csv",a.click(),Q("Keys Exported"),K(!0)},disabled:je,children:"Export CSV"}),Object(A.jsx)(x.a,{variant:"contained",onClick:function(){navigator.clipboard.writeText(m.join("\n")),Q("Keys Copied To Clipboard"),K(!0)},disabled:je,children:"Copy To Clipboard"})]})]}),Object(A.jsx)(U.a,{sx:{width:"100%",bgcolor:"background.paper",borderRadius:"16px",position:"relative",overflow:"auto",maxHeight:300,"& ul":{padding:0},padding:1,"&::-webkit-scrollbar":{width:10},"&::-webkit-scrollbar-track":{backgroundColor:"black"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#808080",borderRadius:2},overflowX:"hidden"},subheader:Object(A.jsx)("li",{}),children:[0].map((function(e){return Object(A.jsx)("li",{children:Object(A.jsx)("ul",{children:m.map((function(t){return Object(A.jsx)(N.a,{children:Object(A.jsx)(H.a,{primary:"".concat(t)})},"item-".concat(e,"-").concat(t))}))})},"section-".concat(e))}))})]})}),Object(A.jsx)(Se,{heading:"How To Create A Vote",content:" 1. Enter the subject of the vote.\\n 2. Enter the number of voters.\\n 3. Enter the options.\\n 4. Click on the Create Vote button.\\n 5. The vote will be created.\\n Vote keys allow voters to authenticate themselves when they vote. Make sure you send one vote key to each voter. A vote key can be used only once. "})]})},Me=n(747),Pe=n(388),Ee=n(766),_e=n(782),ze=n(740),Fe=n(200),Ue=n(171),Ne=n(380),Re=n(199),He=n(761),Ke=n(382),Be=n(140),We=n(744),Ye=n(745),Ge=n(746),Qe=n(62),Je=n(201),Xe=n(387),qe=function(){var e,t,n,a,r,o,i=Object(oe.useStreamQueries)(f.Voting.Voting),l=(null===(e=i.contracts[0])||void 0===e||null===(t=e.payload)||void 0===t?void 0:t.votes)||[],j=(null===(n=i.contracts[0])||void 0===n||null===(a=n.payload)||void 0===a?void 0:a.voters)||[],d=(null===(r=i.contracts[0])||void 0===r||null===(o=r.payload)||void 0===o?void 0:o.voteTimes)||[],x=Math.round(l.length/j.length*100)||0,O=Object(c.useMemo)((function(){if(0!==l.length){var e=new Map;return l.forEach((function(t){e.has(t)?e.set(t,(e.get(t)||1)+1):e.set(t,1)})),Object(ve.a)(e).map((function(e){var t=Object(s.a)(e,2);return{name:t[0],value:t[1]}}))}return[{name:"No Data",value:0}]}),[l]),v=Object(c.useMemo)((function(){for(var e=[],t=0;t<O.length;t++)e.push("#".concat(Math.random().toString(16).slice(2,8)));return e}),[O]),m=Object(c.useMemo)((function(){if(0!==l.length){var e=new Map;return d.forEach((function(t){var n=t.slice(0,-5)+"00000";e.has(parseInt(n))?e.set(parseInt(n),(e.get(parseInt(n))||1)+1):e.set(parseInt(n),1)})),Object(ve.a)(e).map((function(e){var t=Object(s.a)(e,2);return{time:t[0],value:t[1]}})).reverse()}return[{time:1,value:0}]}),[d]),g=function(e){var t=e.active,n=e.payload;return t?Object(A.jsx)(h.a,{sx:{px:2,py:1},children:Object(A.jsx)("div",{className:"custom-tooltip",children:Object(A.jsxs)(b.a,{children:["Votes: ",n[0].value]})})}):null};return Object(A.jsxs)(X.a,{children:[Object(A.jsx)(p.a,{sx:{p:1},children:Object(A.jsxs)(h.a,{sx:{p:3,borderRadius:"16px"},elevation:2,children:[Object(A.jsxs)(u.a,{container:!0,spacing:0,children:[Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(G.a,{sx:{fontSize:50},color:"primary"})}),Object(A.jsxs)(u.a,{item:!0,children:[Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(b.a,{variant:"h5",display:"block",children:"Vote Analytics"})}),Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(b.a,{variant:"subtitle1",color:"secondary",display:"block",style:{lineHeight:"15px"},children:"View current vote results"})})]})]}),Object(A.jsx)(q.a,{}),Object(A.jsx)(p.a,{sx:{pt:3},children:Object(A.jsx)(xe,{})}),Object(A.jsxs)(b.a,{variant:"h5",children:["Votes Counted: ",x,"%"]}),Object(A.jsx)(_e.a,{variant:"determinate",value:x}),Object(A.jsxs)(u.a,{container:!0,justifyContent:"center",alignItems:"center",children:[Object(A.jsx)(u.a,{item:!0,children:Object(A.jsxs)(ze.a,{width:400,height:100,data:O,children:[Object(A.jsx)(Fe.a,{dataKey:"name"}),Object(A.jsx)(Ue.a,{cursor:{fill:"transparent"},content:Object(A.jsx)(g,{active:"",payload:"",label:""})}),Object(A.jsx)(Ne.a,{dataKey:"value",fill:"#387DF6",children:O.map((function(e,t){return Object(A.jsx)(Re.a,{fill:v[t]},"cell-".concat(t))}))})]})}),Object(A.jsx)(u.a,{item:!0,children:Object(A.jsxs)(He.a,{width:400,height:400,children:[Object(A.jsxs)(Ke.a,{data:O,dataKey:"value",nameKey:"name",children:[O.map((function(e,t){return Object(A.jsx)(Re.a,{fill:v[t]},"cell-".concat(t))})),Object(A.jsx)(Be.a,{dataKey:"name"})]}),Object(A.jsx)(Ue.a,{content:Object(A.jsx)(g,{active:"",payload:"",label:""})})]})})]}),Object(A.jsx)(b.a,{variant:"h5",textAlign:"center",children:"Votes Over Time"}),Object(A.jsx)(p.a,{style:{width:"100%",height:"20vh"},textAlign:"center",children:Object(A.jsx)(We.a,{width:"100%",height:"100%",children:Object(A.jsxs)(Ye.a,{width:500,height:300,data:m,margin:{top:5,right:30,left:20,bottom:20},children:[Object(A.jsx)(Ge.a,{strokeDasharray:"3 3"}),Object(A.jsx)(Fe.a,{dataKey:"time",tickFormatter:function(e){return le()(e).format("HH:mm DD/MM/YY")},children:Object(A.jsx)(Qe.a,{value:"Time",fill:"#387DF6",position:"bottom"})}),Object(A.jsx)(Je.a,{allowDecimals:!1,children:Object(A.jsx)(Qe.a,{value:"Votes",fill:"#387DF6",angle:-90})}),Object(A.jsx)(Ue.a,{content:Object(A.jsx)(g,{active:"",payload:"",label:""})}),Object(A.jsx)(Xe.a,{type:"monotone",name:"Votes",dataKey:"value",stroke:"#387DF6",activeDot:{r:8}})]})})})]})}),Object(A.jsx)(Se,{heading:"Vote Analytics Help",content:" This page shows the current vote results and the vote progress. \\n The vote progress shows the percentage of votes cast out of the total number of votes. \\n The votes cast over time chart shows the number of votes that have been cast in relationship to time. \\n "})]})},Ze=function(){var e,t,n,a,c,r=Object(oe.useLedger)(),o=Object(oe.useStreamQueries)(f.Voting.Voting),i=function(){var e,t,n,a,c,r;if(!1===o.loading)return{subject:null===(e=o.contracts[0])||void 0===e||null===(t=e.payload)||void 0===t?void 0:t.subject,voters:null===(n=o.contracts[0])||void 0===n||null===(a=n.payload)||void 0===a?void 0:a.voters,options:null===(c=o.contracts[0])||void 0===c||null===(r=c.payload)||void 0===r?void 0:r.options};return{subject:"Loading...",voters:["Loading..."],options:["Loading..."]}},s=function(){var e=Object(l.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.archiveByKey(f.Voting.Voting,null===(t=o.contracts[0])||void 0===t?void 0:t.signatories[0]);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(A.jsxs)(X.a,{children:[Object(A.jsx)(p.a,{sx:{p:1},children:Object(A.jsxs)(h.a,{sx:{p:3,borderRadius:"16px"},elevation:2,children:[Object(A.jsxs)(u.a,{container:!0,spacing:0,children:[Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(Q.a,{sx:{fontSize:50},color:"primary"})}),Object(A.jsxs)(u.a,{item:!0,children:[Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(b.a,{variant:"h5",display:"block",children:"Vote Management"})}),Object(A.jsx)(u.a,{item:!0,children:Object(A.jsx)(b.a,{variant:"subtitle1",color:"secondary",display:"block",style:{lineHeight:"15px"},children:"Manage active vote"})})]})]}),Object(A.jsxs)(h.a,{sx:{px:5,pb:3,borderRadius:"16px"},variant:"outlined",children:[Object(A.jsx)(b.a,{variant:"h6",sx:{pt:2},children:"Vote Description"}),null!==(e=i().subject)&&void 0!==e?e:"No Active Vote",Object(A.jsx)(q.a,{sx:{pt:2}}),Object(A.jsx)(b.a,{variant:"h6",sx:{pt:2},children:"Vote Options"}),Object(A.jsx)(U.a,{children:null!==(t=null===(n=i().options)||void 0===n?void 0:n.map((function(e,t){return Object(A.jsx)(N.a,{children:Object(A.jsx)(H.a,{primary:t+1+". "+e})},e)})))&&void 0!==t?t:"No Active Vote"}),Object(A.jsx)(q.a,{sx:{pt:2}}),Object(A.jsx)(b.a,{variant:"h6",sx:{pt:2},children:"Number of voters"}),null!==(a=null===(c=i().voters)||void 0===c?void 0:c.length)&&void 0!==a?a:"No Active Vote"]}),Object(A.jsx)(p.a,{textAlign:"center",children:Object(A.jsx)(x.a,{variant:"contained",onClick:s,className:"button",name:"Arcive Vote",sx:{m:2,alignItems:"center"},children:"Delete Vote"})})]})}),Object(A.jsx)(Se,{heading:"Vote Management Help",content:" This page allows you to view the details of the current active vote. \\n You can delete the vote by clicking the button at the bottom of the page. \\n By deleting a vote, users will no longer be able to cast any more votes. \\n Once the vote has been deleted you will be able to create a new vote. "})]})},$e=function(){var e=r.a.useState(),t=Object(s.a)(e,2),n=t[0],a=t[1],c=Object(Me.a)("(prefers-color-scheme: dark)"),o=r.a.useMemo((function(){return Object(Pe.a)({palette:{mode:c?"dark":"light",primary:{main:"#387DF6"},secondary:{main:"#666666"}},typography:{fontFamily:"sans-serif",subtitle1:{fontSize:16},h5:{fontWeight:700,fontSize:24},h6:{fontWeight:500}}})}),[c]);return n?Object(A.jsx)(ie.a,{token:n.token,party:n.party,httpBaseUrl:k,wsBaseUrl:undefined,children:Object(A.jsxs)(Ee.a,{theme:o,children:[Object(A.jsx)(pe.a,{enableColorScheme:!0}),Object(A.jsx)("div",{children:Object(A.jsxs)(w.c,{children:[Object(A.jsx)(w.a,{path:"/Vote",element:Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(Oe,{onLogout:function(){return a(void 0)}})})}),Object(A.jsx)(w.a,{path:"/CreateVote",element:Object(A.jsxs)(A.Fragment,{children:[" ",Object(A.jsx)(J,{onLogout:function(){return a(void 0)}}),Object(A.jsx)(Ie,{})]})}),Object(A.jsx)(w.a,{path:"/VoteAnalytics",element:Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(J,{onLogout:function(){return a(void 0)}}),Object(A.jsx)(qe,{})]})}),Object(A.jsx)(w.a,{path:"/VoteManagement",element:Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(J,{onLogout:function(){return a(void 0)}}),Object(A.jsx)(Ze,{})]})}),Object(A.jsx)(w.a,{path:"*",element:Object(A.jsx)(P,{onLogout:function(){return a(void 0)}})})]})})]})}):Object(A.jsxs)(Ee.a,{theme:o,children:[Object(A.jsx)(pe.a,{enableColorScheme:!0}),Object(A.jsx)("div",{children:Object(A.jsxs)(w.c,{children:[Object(A.jsx)(w.a,{path:"/VoteLogin/*",element:Object(A.jsx)(M,{onLogin:a})}),Object(A.jsx)(w.a,{path:"/VoteLogin",element:Object(A.jsx)(M,{onLogin:a})}),Object(A.jsx)(w.a,{path:"*",element:Object(A.jsx)(I,{onLogin:a})})]})})]})},et=function(e){var t=e.children,n=Object(w.f)();return Object(A.jsx)(S.a,{domain:"votencrypt.au.auth0.com",clientId:"MeM1EPfpL5s7EG7hdki3aBTQa5wuCcYu",redirectUri:window.location.origin,onRedirectCallback:function(e){n((null===e||void 0===e?void 0:e.returnTo)||window.location.pathname)},children:t})};i.a.render(Object(A.jsx)(C.a,{children:Object(A.jsx)(et,{children:Object(A.jsx)($e,{})})}),document.getElementById("root"))}},[[661,1,2]]]);
//# sourceMappingURL=main.1aef365c.chunk.js.map